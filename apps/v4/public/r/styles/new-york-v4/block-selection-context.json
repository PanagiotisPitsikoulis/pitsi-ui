{
  "$schema": "https://pitsiui.com/schema/registry-item.json",
  "name": "block-selection-context",
  "type": "registry:lib",
  "description": "React context for managing block selections in templates with alternatives.",
  "registryDependencies": [
    "templates"
  ],
  "files": [
    {
      "path": "registry/new-york-v4/lib/block-selection-context.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\n\nimport {\n  getBlockTypesWithAlternatives,\n  getDefaultBlockSelections,\n  getSelectedTemplateBlocks,\n  type ComputedTemplateBlock,\n} from \"./templates\"\n\n// Selection state for a template\ninterface BlockSelectionState {\n  templateSlug: string\n  selections: Record<string, string> // blockType -> selected block name\n  blockTypesWithAlternatives: string[]\n}\n\ninterface BlockSelectionContextValue {\n  state: BlockSelectionState | null\n  setTemplateSlug: (slug: string) => void\n  selectBlock: (blockType: string, blockName: string) => void\n  getSelectedBlocks: () => ComputedTemplateBlock[]\n  isBlockSelected: (blockName: string) => boolean\n  getSelectedBlockForType: (blockType: string) => string | undefined\n}\n\nconst BlockSelectionContext =\n  React.createContext<BlockSelectionContextValue | null>(null)\n\nexport function useBlockSelection() {\n  const context = React.useContext(BlockSelectionContext)\n  if (!context) {\n    throw new Error(\n      \"useBlockSelection must be used within a BlockSelectionProvider\"\n    )\n  }\n  return context\n}\n\ninterface BlockSelectionProviderProps {\n  children: React.ReactNode\n  initialTemplateSlug?: string\n}\n\nexport function BlockSelectionProvider({\n  children,\n  initialTemplateSlug,\n}: BlockSelectionProviderProps) {\n  const [state, setState] = React.useState<BlockSelectionState | null>(() => {\n    if (!initialTemplateSlug) return null\n    return {\n      templateSlug: initialTemplateSlug,\n      selections: getDefaultBlockSelections(initialTemplateSlug),\n      blockTypesWithAlternatives:\n        getBlockTypesWithAlternatives(initialTemplateSlug),\n    }\n  })\n\n  const setTemplateSlug = React.useCallback((slug: string) => {\n    setState({\n      templateSlug: slug,\n      selections: getDefaultBlockSelections(slug),\n      blockTypesWithAlternatives: getBlockTypesWithAlternatives(slug),\n    })\n  }, [])\n\n  const selectBlock = React.useCallback(\n    (blockType: string, blockName: string) => {\n      setState((prev) => {\n        if (!prev) return null\n        return {\n          ...prev,\n          selections: {\n            ...prev.selections,\n            [blockType]: blockName,\n          },\n        }\n      })\n    },\n    []\n  )\n\n  const getSelectedBlocks = React.useCallback((): ComputedTemplateBlock[] => {\n    if (!state) return []\n    return getSelectedTemplateBlocks(state.templateSlug, state.selections)\n  }, [state])\n\n  const isBlockSelected = React.useCallback(\n    (blockName: string): boolean => {\n      if (!state) return false\n      return Object.values(state.selections).includes(blockName)\n    },\n    [state]\n  )\n\n  const getSelectedBlockForType = React.useCallback(\n    (blockType: string): string | undefined => {\n      return state?.selections[blockType]\n    },\n    [state]\n  )\n\n  const value = React.useMemo<BlockSelectionContextValue>(\n    () => ({\n      state,\n      setTemplateSlug,\n      selectBlock,\n      getSelectedBlocks,\n      isBlockSelected,\n      getSelectedBlockForType,\n    }),\n    [\n      state,\n      setTemplateSlug,\n      selectBlock,\n      getSelectedBlocks,\n      isBlockSelected,\n      getSelectedBlockForType,\n    ]\n  )\n\n  return (\n    <BlockSelectionContext.Provider value={value}>\n      {children}\n    </BlockSelectionContext.Provider>\n  )\n}\n",
      "type": "registry:lib"
    }
  ],
  "readiness": "production"
}