{
  "$schema": "https://pitsiui.com/schema/registry-item.json",
  "name": "cards-parallax",
  "type": "registry:ui",
  "description": "Cards that stack and scale on scroll with parallax effect.",
  "dependencies": [
    "motion"
  ],
  "registryDependencies": [
    "utils",
    "use-animation-state",
    "use-mobile"
  ],
  "files": [
    {
      "path": "registry/new-york-v4/animations/cards-parallax/cards-parallax.tsx",
      "content": "\"use client\"\n\nimport type { ReactNode } from \"react\"\nimport { createContext, memo, useContext, useMemo, useRef } from \"react\"\nimport { motion, MotionValue, useScroll, useTransform } from \"motion/react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { useAnimationState } from \"@/hooks/use-animation-state\"\nimport { useIsMobile } from \"@/hooks/use-mobile\"\n\n// Context to share scroll progress\nconst ScrollProgressContext = createContext<{\n  scrollYProgress: MotionValue<number>\n  totalCards: number\n} | null>(null)\n\nexport type CardsParallaxContainerProps = {\n  /** Number of cards (used for scale calculation) */\n  cardCount: number\n  /** Container children */\n  children: ReactNode\n  /** Additional CSS classes */\n  className?: string\n  /** Enable scroll-based animation. Default: true */\n  scrollBased?: boolean\n  /** Disable animation on mobile. Default: false */\n  noMobile?: boolean\n}\n\n/**\n * Container for stacking parallax cards.\n * Provides scroll progress context to child ParallaxCard components.\n */\nexport const CardsParallaxContainer = memo<CardsParallaxContainerProps>(\n  ({\n    cardCount,\n    children,\n    className,\n    scrollBased = true,\n    noMobile = false,\n  }) => {\n    const ref = useRef<HTMLDivElement>(null)\n    const { shouldUseScroll } = useAnimationState(scrollBased, noMobile)\n\n    const { scrollYProgress } = useScroll({\n      target: shouldUseScroll ? ref : undefined,\n      offset: [\"start start\", \"end end\"],\n    })\n\n    return (\n      <ScrollProgressContext.Provider\n        value={{ scrollYProgress, totalCards: cardCount }}\n      >\n        <div ref={ref} className={cn(\"relative\", className)}>\n          {children}\n        </div>\n      </ScrollProgressContext.Provider>\n    )\n  }\n)\n\nCardsParallaxContainer.displayName = \"CardsParallaxContainer\"\n\nexport type ParallaxCardProps = {\n  /** Card index (0-based) */\n  index: number\n  /** Card content */\n  children: ReactNode\n  /** Background color */\n  backgroundColor?: string\n  /** Additional CSS classes */\n  className?: string\n  /** Vertical offset per card in pixels. Default: 25 */\n  cardOffset?: number\n  /** Scale step per card. Default: 0.05 */\n  scaleStep?: number\n  /** Enable scroll-based animation. Default: true */\n  scrollBased?: boolean\n  /** Disable animation on mobile. Default: false */\n  noMobile?: boolean\n}\n\n/**\n * Individual parallax card that scales and stacks on scroll.\n * Use inside CardsParallaxContainer.\n */\nexport const ParallaxCard = memo<ParallaxCardProps>(\n  ({\n    index,\n    children,\n    backgroundColor,\n    className,\n    cardOffset = 25,\n    scaleStep = 0.05,\n    scrollBased = true,\n    noMobile = false,\n  }) => {\n    const context = useContext(ScrollProgressContext)\n    const { shouldDisableAnimation } = useAnimationState(scrollBased, noMobile)\n    const isMobile = useIsMobile()\n\n    const adjustedOffset = isMobile ? cardOffset * 0.6 : cardOffset\n\n    const targetScale = context\n      ? 1 - (context.totalCards - index) * scaleStep\n      : 1\n    const range: [number, number] = [index * 0.25, 1]\n\n    const scale = useTransform(\n      context?.scrollYProgress || new MotionValue(0),\n      range,\n      [1, targetScale]\n    )\n\n    if (shouldDisableAnimation || !context) {\n      return (\n        <div\n          className={cn(\n            \"flex h-[500px] w-[1000px] max-w-[90vw] flex-col rounded-3xl p-8 md:p-12\",\n            className\n          )}\n          style={{ backgroundColor }}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    return (\n      <div className=\"sticky top-0 flex h-screen items-center justify-center\">\n        <motion.div\n          style={{\n            backgroundColor,\n            scale,\n            top: `calc(-5vh + ${index * adjustedOffset}px)`,\n          }}\n          className={cn(\n            \"relative flex h-[500px] w-[1000px] max-w-[90vw] origin-top flex-col rounded-3xl p-8 md:p-12\",\n            className\n          )}\n        >\n          {children}\n        </motion.div>\n      </div>\n    )\n  }\n)\n\nParallaxCard.displayName = \"ParallaxCard\"\n\nexport type ParallaxCardImageProps = {\n  /** Image source */\n  src: string\n  /** Alt text */\n  alt: string\n  /** Additional CSS classes */\n  className?: string\n  /** Enable scroll-based animation. Default: true */\n  scrollBased?: boolean\n  /** Disable animation on mobile. Default: false */\n  noMobile?: boolean\n}\n\n/**\n * Image with zoom-in parallax effect for use inside ParallaxCard.\n * Zooms from 2x to 1x as it scrolls into view.\n */\nexport const ParallaxCardImage = memo<ParallaxCardImageProps>(\n  ({ src, alt, className, scrollBased = true, noMobile = false }) => {\n    const ref = useRef<HTMLDivElement>(null)\n    const { shouldDisableAnimation, shouldUseScroll } = useAnimationState(\n      scrollBased,\n      noMobile\n    )\n\n    const { scrollYProgress } = useScroll({\n      target: shouldUseScroll ? ref : undefined,\n      offset: [\"start end\", \"start start\"],\n    })\n\n    const imageScale = useTransform(scrollYProgress, [0, 1], [2, 1])\n\n    if (shouldDisableAnimation) {\n      return (\n        <div\n          ref={ref}\n          className={cn(\n            \"relative h-full w-full overflow-hidden rounded-3xl\",\n            className\n          )}\n        >\n          <img src={src} alt={alt} className=\"h-full w-full object-cover\" />\n        </div>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"relative h-full w-full overflow-hidden rounded-3xl\",\n          className\n        )}\n      >\n        <motion.div className=\"h-full w-full\" style={{ scale: imageScale }}>\n          <img src={src} alt={alt} className=\"h-full w-full object-cover\" />\n        </motion.div>\n      </div>\n    )\n  }\n)\n\nParallaxCardImage.displayName = \"ParallaxCardImage\"\n\n// Legacy export\nexport const CardsParallax = CardsParallaxContainer\n\nexport default CardsParallaxContainer\n",
      "type": "registry:ui"
    }
  ],
  "categories": [
    "animations"
  ],
  "tier": "free",
  "readiness": "beta"
}