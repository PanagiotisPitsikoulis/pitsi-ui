{
  "$schema": "https://pitsiui.com/schema/registry-item.json",
  "name": "scroll-scale",
  "type": "registry:ui",
  "description": "Content that scales up as you scroll into view.",
  "dependencies": [
    "motion"
  ],
  "registryDependencies": [
    "use-animation-state"
  ],
  "files": [
    {
      "path": "registry/new-york-v4/animations/scroll-scale/scroll-scale.tsx",
      "content": "\"use client\"\n\nimport type { ReactNode } from \"react\"\nimport { createContext, memo, useContext, useMemo, useRef } from \"react\"\nimport { motion, MotionValue, useScroll, useTransform } from \"motion/react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { useAnimationState } from \"@/hooks/use-animation-state\"\n\n// Context for scroll progress\nconst ScrollScaleContext = createContext<{\n  scrollYProgress: MotionValue<number>\n  totalCards: number\n} | null>(null)\n\nexport type ScrollScaleContainerProps = {\n  /** Card components */\n  children: ReactNode\n  /** Number of cards (for scroll height calculation) */\n  cardCount: number\n  /** Additional CSS classes */\n  className?: string\n  /** Container classes for the card wrapper */\n  containerClassName?: string\n  /** Enable scroll-based animation. Default: true */\n  scrollBased?: boolean\n  /** Disable animation on mobile. Default: false */\n  noMobile?: boolean\n}\n\n/**\n * Container for scroll-triggered stacking cards.\n * Cards scale down and rotate as the next card slides up.\n */\nexport const ScrollScaleContainer = memo<ScrollScaleContainerProps>(\n  ({\n    children,\n    cardCount,\n    className,\n    containerClassName,\n    scrollBased = true,\n    noMobile = false,\n  }) => {\n    const ref = useRef<HTMLDivElement>(null)\n    const { shouldUseScroll, shouldDisableAnimation } = useAnimationState(\n      scrollBased,\n      noMobile\n    )\n\n    const { scrollYProgress } = useScroll({\n      target: shouldUseScroll ? ref : undefined,\n      offset: [\"start start\", \"end end\"],\n    })\n\n    const scrollHeight = `${100 * cardCount}vh`\n\n    if (shouldDisableAnimation) {\n      return (\n        <div\n          className={cn(\"relative\", className)}\n          style={{ height: scrollHeight }}\n        >\n          <div className=\"sticky top-0 flex h-screen items-center justify-center overflow-hidden p-3 lg:p-8\">\n            <div\n              className={cn(\n                \"relative h-[90%] w-full max-w-sm overflow-hidden rounded-lg sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl 2xl:max-w-3xl\",\n                containerClassName\n              )}\n            >\n              {children}\n            </div>\n          </div>\n        </div>\n      )\n    }\n\n    return (\n      <ScrollScaleContext.Provider\n        value={{ scrollYProgress, totalCards: cardCount }}\n      >\n        <div\n          ref={ref}\n          className={cn(\"relative\", className)}\n          style={{ height: scrollHeight }}\n        >\n          <div className=\"sticky top-0 flex h-screen items-center justify-center overflow-hidden p-3 lg:p-8\">\n            <div\n              className={cn(\n                \"relative h-[90%] w-full max-w-sm overflow-hidden rounded-lg sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl 2xl:max-w-3xl\",\n                containerClassName\n              )}\n            >\n              {children}\n            </div>\n          </div>\n        </div>\n      </ScrollScaleContext.Provider>\n    )\n  }\n)\n\nScrollScaleContainer.displayName = \"ScrollScaleContainer\"\n\nexport type ScrollScaleCardProps = {\n  /** Card index (0-based) */\n  index: number\n  /** Image source URL */\n  src: string\n  /** Alt text for accessibility */\n  alt?: string\n  /** Additional CSS classes */\n  className?: string\n  /** Scale when card is pushed back. Default: 0.7 */\n  targetScale?: number\n  /** Rotation when card is pushed back. Default: 5 */\n  targetRotation?: number\n  /** Enable scroll-based animation. Default: true */\n  scrollBased?: boolean\n  /** Disable animation on mobile. Default: false */\n  noMobile?: boolean\n}\n\n/**\n * Individual card in a scroll-scale stack.\n * Use inside ScrollScaleContainer.\n */\nexport const ScrollScaleCard = memo<ScrollScaleCardProps>(\n  ({\n    index,\n    src,\n    alt = \"Card image\",\n    className,\n    targetScale = 0.7,\n    targetRotation = 5,\n    scrollBased = true,\n    noMobile = false,\n  }) => {\n    const context = useContext(ScrollScaleContext)\n    const { shouldDisableAnimation } = useAnimationState(scrollBased, noMobile)\n\n    // Calculate ranges for this card\n    const totalCards = context?.totalCards || 1\n    const segmentSize = 1 / totalCards\n\n    // Current card's animation range\n    const startProgress = index * segmentSize\n    const endProgress = (index + 1) * segmentSize\n\n    // Scale animation (card scales down when its segment is active)\n    const scale = useTransform(\n      context?.scrollYProgress || new MotionValue(0),\n      [startProgress, endProgress],\n      [1, targetScale]\n    )\n\n    // Rotation animation (card rotates when its segment is active)\n    const rotate = useTransform(\n      context?.scrollYProgress || new MotionValue(0),\n      [startProgress, endProgress],\n      [0, targetRotation]\n    )\n\n    // Y position (next cards slide up)\n    const y = useTransform(\n      context?.scrollYProgress || new MotionValue(0),\n      index === 0 ? [0, 1] : [(index - 1) * segmentSize, index * segmentSize],\n      index === 0 ? [\"0%\", \"0%\"] : [\"100%\", \"0%\"]\n    )\n\n    // Z-index based on index (later cards on top)\n    const zIndex = index\n\n    if (shouldDisableAnimation || !context) {\n      return (\n        <img\n          src={src}\n          alt={alt}\n          className={cn(\n            \"absolute h-full w-full rounded-4xl object-cover\",\n            className\n          )}\n          style={{ zIndex }}\n        />\n      )\n    }\n\n    return (\n      <motion.img\n        src={src}\n        alt={alt}\n        className={cn(\n          \"absolute h-full w-full rounded-4xl object-cover\",\n          className\n        )}\n        style={{\n          scale,\n          rotate,\n          y,\n          zIndex,\n        }}\n      />\n    )\n  }\n)\n\nScrollScaleCard.displayName = \"ScrollScaleCard\"\n\n// Original simple scroll scale component\nexport type ScrollScaleProps = {\n  children: ReactNode\n  className?: string\n  delay?: number\n  duration?: number\n  startScale?: number\n  endScale?: number\n  scrollBased?: boolean\n  noMobile?: boolean\n}\n\n/**\n * Simple element that scales and fades in on scroll.\n */\nexport const ScrollScale = memo<ScrollScaleProps>(\n  ({\n    children,\n    className,\n    delay = 0,\n    duration = 0.6,\n    startScale = 0.8,\n    endScale = 1,\n    scrollBased = true,\n    noMobile = false,\n  }) => {\n    const ref = useRef<HTMLDivElement>(null)\n    const { shouldDisableAnimation, shouldUseScroll } = useAnimationState(\n      scrollBased,\n      noMobile\n    )\n\n    const { scrollYProgress } = useScroll({\n      target: shouldUseScroll ? ref : undefined,\n      offset: [\"start end\", \"start center\"],\n    })\n\n    const scale = useTransform(scrollYProgress, [0, 1], [startScale, endScale])\n    const opacity = useTransform(scrollYProgress, [0, 1], [0, 1])\n\n    if (shouldDisableAnimation) {\n      return <div className={className}>{children}</div>\n    }\n\n    if (scrollBased) {\n      return (\n        <motion.div ref={ref} style={{ scale, opacity }} className={className}>\n          {children}\n        </motion.div>\n      )\n    }\n\n    return (\n      <motion.div\n        initial={{ opacity: 0, scale: startScale }}\n        whileInView={{ opacity: 1, scale: endScale }}\n        viewport={{ once: false, margin: \"-100px\" }}\n        transition={{ duration, delay, ease: [0.25, 0.4, 0.25, 1] }}\n        className={className}\n      >\n        {children}\n      </motion.div>\n    )\n  }\n)\n\nScrollScale.displayName = \"ScrollScale\"\n\nexport default ScrollScaleContainer\n",
      "type": "registry:ui"
    }
  ],
  "categories": [
    "animations"
  ],
  "tier": "free",
  "readiness": "beta",
  "poweredBy": [
    {
      "name": "Skiper UI",
      "url": "https://skiper-ui.com"
    }
  ]
}